thres_type = str_replace(thres_type, "se_", "")
)
)
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(. ~ thres_type) +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
permd_sum_thres2 <- permd_sum_thres %>% filter(type == thresDist_raw)
permd_sum_thres2 <- permd_sum_thres %>% filter(thres_type == "thresDist_raw")
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(. ~ thres_type) +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
permd_sum_thres2 <- permd_sum_thres %>% filter(thres_type == "thresDist_raw")
p3 <- ggplot(permd_sum_thres2, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(. ~ thres_type) +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
View(permd_sum_thres)
permd_sum_thres2 <- permd_sum_thres %>% filter(thres_type == "thresDist_raw")
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ .) +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
permd_sum_thres2 <- permd_sum_thres %>% filter(thres_type == "thresDist_raw")
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ., scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
permd_sum_thres2 <- permd_sum_thres %>% filter(thres_type == "thresDist_raw")
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ., scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
scale_x_continuous(values = seq(5, 80, by = 5)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
permd_sum_thres2 <- permd_sum_thres %>% filter(thres_type == "thresDist_raw")
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ., scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
scale_x_continuous(breaks = seq(5, 80, by = 5)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
library(here)
library(Rcurvep)
library(tibble)
library(dplyr)
library(tidyr)
library(stringr)
library(purrr)
library(ggplot2)
generate_diagnostic_plot(temp1[[1]][[1]])
generate_diagnostic_plot(temp1[[1]][[3]])
temp1[[1]][[3]]
temp1[[1]][[2]]
temp1[[4]][[3]]
temp1[[4]][[2]]
temp1[[4]][[1]]
temp2 <- temp1[[4]][[1]]
View(temp2)
View(permd_sum)
View(permd)
test1 <- readRDS("Z:/hsiehj2/Projects/R_code/NIEHS/Rcurvep/data-raw/big_dataset/perm_percent80/10-1000-1000.rds")
generate_diagnostic_plot(test1[[228]][[1]])
temp1 <- readRDS("Z:/hsiehj2/Projects/R_code/NIEHS/Rcurvep/data-raw/big_dataset/perm_percent80/15-1000-1000.rds")
generate_diagnostic_plot(test1[[5]][[1]])
test1[[5]][[3]]
test1[[5]][[2]]
read_perm_rds <- function(filn, dir) {
print(filn)
pars <- str_replace(filn, ".rds", "") %>%
str_split(., "-") %>% unlist() %>% as.numeric() %>%
set_names(c("n_chemical", "n_perm", "n_times"))
result <- readRDS(file.path(dir, filn)) %>%
map_df(., ~ .x[[2]], .id = "perm_id") %>%
mutate(
n_chemical = pars[["n_chemical"]],
n_perm = pars[['n_perm']]
)
return(result)
}
permd <- list.files(here("data-raw", "big_dataset", "perm_percent80"), pattern = "rds")
permd <- map_df(permd, function(x) {read_perm_rds(filn = x, dir = here("data-raw", "big_dataset", "perm_percent80"))})
temp1 <- readRDS("Z:/hsiehj2/Projects/R_code/NIEHS/Rcurvep/data-raw/big_dataset/perm_percent80/15-1000-1000.rds")
temp1[[5]][[2]]
generate_diagnostic_plot(temp1[[5]][[1]])
generate_diagnostic_plot(temp1[[148]][[1]])
permd
permd %>%
group_by(n_chemical, n_perm, endpoint, direction) %>%
filter(thresComment != "check")
permd_sum <- permd %>%
group_by(n_chemical, n_perm, endpoint, direction) %>%
filter(thresComment != "check") %>%
summarise(
mean_thresDist_raw = mean(thresDist_raw, na.rm = TRUE),
se_thresDist_raw = sd(thresDist_raw, na.rm = TRUE)/sqrt(n()),
mean_thresDist_exp = mean(thresDist_exp, na.rm = TRUE),
se_thresDist_exp = sd(thresDist_exp, na.rm = TRUE)/sqrt(n()),
fraction_check = sum(thresComment == "check")/n(),
fraction_badfit = sum(cor_exp_fit < 0.95 | is.na(cor_exp_fit))/n()
)
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line()
p1
permd_sum <- permd %>%
group_by(n_chemical, n_perm, endpoint, direction) %>%
#filter(thresComment != "check") %>%
summarise(
mean_thresDist_raw = mean(thresDist_raw[thresComment != "check"], na.rm = TRUE),
se_thresDist_raw = sd(thresDist_raw[thresComment != "check"], na.rm = TRUE)/sqrt(n()),
mean_thresDist_exp = mean(thresDist_exp[thresComment != "check"], na.rm = TRUE),
se_thresDist_exp = sd(thresDist_exp[thresComment != "check"], na.rm = TRUE)/sqrt(n()),
fraction_check = sum(thresComment == "check")/n(),
fraction_badfit = sum(cor_exp_fit < 0.95 | is.na(cor_exp_fit))/n()
)
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line()
p1
p2 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_badfit, color = as.factor(n_perm)))
p2 <- p2 + geom_point() +
geom_line()
p2
permd_sum_thres <- permd_sum %>%
select(mean_thresDist_raw, mean_thresDist_exp) %>%
gather(thres_type, mean_thres, mean_thresDist_raw, mean_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "mean_", "")
) %>%
inner_join(
permd_sum %>%
select(se_thresDist_raw, se_thresDist_exp) %>%
gather(thres_type, se_thres, se_thresDist_raw, se_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "se_", "")
)
)
permd_sum_thres2 <- permd_sum_thres %>% filter(thres_type == "thresDist_raw")
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ., scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
scale_x_continuous(breaks = seq(5, 80, by = 5)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
library(here)
library(Rcurvep)
library(tibble)
library(dplyr)
library(tidyr)
library(stringr)
library(purrr)
library(ggplot2)
zfishdev_boot <- readRDS(here("data-raw", "big_dataset", "biobide32_percent_boot_1000.rds"))
bootd <- zfishdev_boot[["percent_affected_96"]]
#make old format as the new one
bootd <- bootd %>%
rename(threshold = thres) %>%
separate(dduid, c("endpoint", "chemical", "direction"), sep = "#") %>%
separate(direction, c("directionality", "direction"), sep = "@") %>%
select(-directionality)
acts <- extract_curvep_data(bootd, "act")
sum_act <- extract_curvep_data(bootd, "summary", "INVERSE")
sum_act_hit <- sum_act %>%
group_by(chemical, endpoint, direction) %>%
summarize(hit_confidence = mean(hit_confidence))
actived <- sum_act_hit %>% filter(hit_confidence > 0.5)
inactived <- sum_act_hit %>% filter(hit_confidence <= 0.5)
p1 <- ggplot(sum_act_hit, aes(x = hit_confidence)) + geom_histogram()
p1
subset_boot_data <- function(dd, n_chemical, n_sample) {
sel_sample_ids <- seq(1:1000)
if (n_sample != 1000) sel_sample_ids <- sample(1:1000, n_sample)
chem_names <- dd %>% pull(chemical) %>% unique()
sel_chem_names <- sample(chem_names, n_chemical)
dd_p <- dd %>%
filter(chemical %in% sel_chem_names) %>%
filter(repeat_id %in% sel_sample_ids)
acts <- dd_p %>% #extract_curvep_data(dd_p, "act") %>%
mutate(POD = ifelse(is.na(POD), conc_highest, POD))
result <- acts %>% identify_basenoise_threshold(., plot = FALSE)
return(list(thres_d = result[[1]], thres_o = result[[2]], sel_chem = sel_chem_names, sel_sample = sel_sample_ids))
}
read_perm_rds <- function(filn, dir) {
pars <- str_replace(filn, ".rds", "") %>%
str_split(., "-") %>% unlist() %>% as.numeric() %>%
set_names(c("n_chemical", "n_perm", "n_times"))
result <- readRDS(file.path(dir, filn)) %>%
map_df(., ~ .x[[2]], .id = "perm_id") %>%
mutate(
n_chemical = pars[["n_chemical"]],
n_perm = pars[['n_perm']]
)
return(result)
}
save_subset_result <- function(n_chemical, n_sample, times, original_data, dir) {
result <- map(1:times, function(z) {
result <- subset_boot_data(dd = original_data, n_chemical = n_chemical, n_sample = n_sample)
})
saveRDS(result, file.path(dir, paste0(n_chemical, "-", n_sample, "-", times, ".rds")))
}
set.seed(19800925)
paras <- expand.grid(seq(5, 30, by = 5), c(10, 100, 1000)) %>% set_names(c("n_chemical", "n_sample"))
system.time(pmap(paras, save_subset_result, times = 1000, dir = here("data-raw", "big_dataset", "perm_percent"), original_data = acts))
permd <- list.files(here("data-raw", "big_dataset", "perm_percent"), pattern = "rds")
permd <- map_df(permd, function(x) {read_perm_rds(filn = x, dir = here("data-raw", "big_dataset", "perm_percent"))})
permd_sum1 <- permd %>%
group_by(n_chemical, n_perm, endpoint, direction) %>%
summarise(
fraction_check = sum(thresComment == "check")/n(),
fraction_badfit = sum(cor_exp_fit < 0.95 | is.na(cor_exp_fit))/n()
)
permd_sum2 <- permd %>%
filter(thresComment != "check") %>%
group_by(n_chemical, n_perm, endpoint, direction) %>%
summarize(
mean_thresDist_raw = mean(thresDist_raw, na.rm = TRUE),
se_thresDist_raw = sd(thresDist_raw, na.rm = TRUE)/sqrt(n()),
mean_thresDist_exp = mean(thresDist_exp, na.rm = TRUE),
se_thresDist_exp = sd(thresDist_exp, na.rm = TRUE)/sqrt(n())
)
permd_sum <- inner_join(permd_sum1, permd_sum2)
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line()
p1
p2 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_badfit, color = as.factor(n_perm)))
p2 <- p2 + geom_point() +
geom_line()
p2
permd_sum_thres <- permd_sum %>%
select(mean_thresDist_raw, mean_thresDist_exp) %>%
gather(thres_type, mean_thres, mean_thresDist_raw, mean_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "mean_", "")
) %>%
inner_join(
permd_sum %>%
select(se_thresDist_raw, se_thresDist_exp) %>%
gather(thres_type, se_thres, se_thresDist_raw, se_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "se_", "")
)
)
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ., scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
scale_x_continuous(breaks = seq(5, 80, by = 5)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
permd1 <- list.files(here("data-raw", "big_dataset", "perm_percent"), pattern = "rds")
permd1 <- map_df(permd1, function(x) {read_perm_rds(filn = x, dir = here("data-raw", "big_dataset", "perm_percent"))})
permd2 <- list.files(here("data-raw", "big_dataset", "perm_percent", "v0.5"), pattern = "rds")
permd2 <- map_df(permd2, function(x) {read_perm_rds(filn = x, dir = here("data-raw", "big_dataset", "perm_percent", "v0.5"))})
permd_sum1 < calculate_metrics(permd1) %>% mutate(ver = "SSasymp")
calculate_metrics <- function(dd) {
permd_sum1 <- dd %>%
group_by(n_chemical, n_perm, endpoint, direction) %>%
summarise(
fraction_check = sum(thresComment == "check")/n(),
fraction_badfit = sum(cor_exp_fit < 0.95 | is.na(cor_exp_fit))/n()
)
permd_sum2 <- dd %>%
filter(thresComment != "check") %>%
group_by(n_chemical, n_perm, endpoint, direction) %>%
summarize(
mean_thresDist_raw = mean(thresDist_raw, na.rm = TRUE),
se_thresDist_raw = sd(thresDist_raw, na.rm = TRUE)/sqrt(n()),
mean_thresDist_exp = mean(thresDist_exp, na.rm = TRUE),
se_thresDist_exp = sd(thresDist_exp, na.rm = TRUE)/sqrt(n())
)
permd_sum <- inner_join(permd_sum1, permd_sum2)
return(permd_sum)
}
permd_sum1 < calculate_metrics(permd1) %>% mutate(ver = "SSasymp")
permd_sum1 <- calculate_metrics(permd1) %>% mutate(ver = "SSasymp")
permd_sum2 <- calculate_metrics(permd2) %>% mutate(ver = "lmstart")
permd_sum <- bind_rows(permd_sum1, permd_sum2)
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line() + facet_wrap(~ ver, scales = "free")
p1
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line() + facet_wrap(~ ver)
p1
p2 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_badfit, color = as.factor(n_perm)))
p2 <- p2 + geom_point() +
geom_line()  + facet_wrap(~ ver)
p2
permd_sum_thres <- permd_sum %>%
select(mean_thresDist_raw, mean_thresDist_exp) %>%
gather(thres_type, mean_thres, mean_thresDist_raw, mean_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "mean_", "")
) %>%
inner_join(
permd_sum %>%
select(se_thresDist_raw, se_thresDist_exp) %>%
gather(thres_type, se_thres, se_thresDist_raw, se_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "se_", "")
)
)
View(permd_sum_thres)
?group_by
permd_sum1 <- calculate_metrics(permd1) %>% mutate(ver = "SSasymp")
permd_sum2 <- calculate_metrics(permd2) %>% mutate(ver = "lmstart")
permd_sum <- bind_rows(permd_sum1, permd_sum2) %>% group_by(ver, add = TRUE)
permd_sum
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line() + facet_wrap(~ ver)
p1
p2 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_badfit, color = as.factor(n_perm)))
p2 <- p2 + geom_point() +
geom_line()  + facet_wrap(~ ver)
p2
permd_sum_thres <- permd_sum %>%
select(mean_thresDist_raw, mean_thresDist_exp) %>%
gather(thres_type, mean_thres, mean_thresDist_raw, mean_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "mean_", "")
) %>%
inner_join(
permd_sum %>%
select(se_thresDist_raw, se_thresDist_exp) %>%
gather(thres_type, se_thres, se_thresDist_raw, se_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "se_", "")
)
)
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ., scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
scale_x_continuous(breaks = seq(5, 80, by = 5)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ver, scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
scale_x_continuous(breaks = seq(5, 80, by = 5)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line() + facet_grid(. ~ ver)
p1
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line() + facet_grid(ver ~ .)
p1
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line() + facet_grid(ver ~ ., scales = "free")
p1
p2 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_badfit, color = as.factor(n_perm)))
p2 <- p2 + geom_point() +
geom_line()  +  facet_grid(ver ~ ., scales = "free")
p2
View(permd_sum)
permd_sum %>%
filter(n_perm == 100) %>%
arrange(fraction_check)
permd_sum %>%
filter(n_perm == 100) %>%
arrange(fraction_badfit)
actived
zfishdev_boot <- readRDS(here("data-raw", "big_dataset", "biobide_percent_boot_1000_nonoise_newformat.rds"))
bootd <- zfishdev_boot %>% filter(endpoint == "119") ## percent_affected_96"
acts <- bootd
sum_act <- bootd %>% mutate(wAUC_prev = as.numeric(NA)) %>%
summarize_curvep_output(., col_names = c("POD"), modifier = "INVERSE")
sum_act_hit <- sum_act %>%
group_by(chemical, endpoint, direction) %>%
summarize(hit_confidence = mean(hit_confidence))
actived <- sum_act_hit %>% filter(hit_confidence > 0.5)
inactived <- sum_act_hit %>% filter(hit_confidence <= 0.5)
p1 <- ggplot(sum_act_hit, aes(x = hit_confidence)) + geom_histogram()
p1
actived
inactived
permd <- list.files(here("data-raw", "big_dataset", "perm_percent80"), pattern = "rds")
permd <- map_df(permd, function(x) {read_perm_rds(filn = x, dir = here("data-raw", "big_dataset", "perm_percent80"))})
permd_sum <- calculate_metrics(permd) %>% mutate(ver = "SSasymp")
permd_sum <- permd_sum %>% group_by(ver, add = TRUE)
p1 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_check, color = as.factor(n_perm)))
p1 <- p1 + geom_point() +
geom_line() + facet_grid(ver ~ ., scales = "free")
p1
p2 <- ggplot(permd_sum, aes(x = n_chemical, y = fraction_badfit, color = as.factor(n_perm)))
p2 <- p2 + geom_point() +
geom_line()  +  facet_grid(ver ~ ., scales = "free")
p2
permd_sum_thres <- permd_sum %>%
select(mean_thresDist_raw, mean_thresDist_exp) %>%
gather(thres_type, mean_thres, mean_thresDist_raw, mean_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "mean_", "")
) %>%
inner_join(
permd_sum %>%
select(se_thresDist_raw, se_thresDist_exp) %>%
gather(thres_type, se_thres, se_thresDist_raw, se_thresDist_exp) %>%
mutate(
thres_type = str_replace(thres_type, "se_", "")
)
)
p3 <- ggplot(permd_sum_thres, aes(x = n_chemical, y = mean_thres, color = as.factor(n_perm)))
p3 <- p3 + geom_point() +
geom_line() +
facet_grid(thres_type ~ ver, scales = "free") +
geom_hline(yintercept = 25) +
scale_y_continuous(breaks = seq(18, 36, by = 2)) +
scale_x_continuous(breaks = seq(5, 80, by = 5)) +
geom_errorbar(aes(ymin = mean_thres - se_thres, ymax = mean_thres + se_thres), width = 0.2)
p3
permd_sum %>%
filter(n_perm == 100) %>%
arrange(fraction_check)
permd_sum %>%
filter(n_perm == 100) %>%
arrange(fraction_badfit)
permd_sum %>%
filter(n_perm == 100 & n_chemical <= 40) %>%
arrange(fraction_check)
permd_sum %>%
filter(n_perm == 100 & n_chemical <= 40) %>%
arrange(fraction_badfit)
temp1 <- readRDS("Z:/hsiehj2/Projects/R_code/NIEHS/Rcurvep/data-raw/big_dataset/perm_percent80/5-1000-1000.rds")
temp1[[45]][[2]]
generate_diagnostic_plot(temp1[[45]][[1]])
generate_diagnostic_plot(temp1[[463]][[1]])
generate_diagnostic_plot(temp1[[463]][[2]])
temp1[[463]][[2]]
temp1[[463]][[2]]$cor_exp_fit
temp1[[463]][[2]]$cor_lm_fit
generate_diagnostic_plot(temp1[[177]][[1]])
0.9798667 - 0.7577453
?Rcurvep
sessionInfo()
library(Rcurvep)
?`Rcurvep-package`
library(Rcurvep)
?run_curvep_job
print
?join
devtools::test(filter = "out")
devtools::test(filter = "out")
devtools::test(filter = "out")
devtools::test(filter = "run")
?Rcurvep
?run_curvep_job
devtools::test(filter = "run")
devtools::test(filter = "out")
?inherits
?invisible
devtools::test(filter = "reparam")
devtools::test(filter = "reparam")
plot.design()
endpoint <- "endpoint"
rlang::sym(endpoint)
list(n_page = 4)
temp1 <- list(n_page = 4)
temp1[['n_page']]
exists(temp1[['n_page']])
is.null(temp1[['n_page']])
is.null(temp1$xx)
?ifelse
ifelse(!is.null(temp1$n_page), temp1$n_page, 5)
ifelse(!is.null(temp1$xx), temp1$xx, 5)
!is.null(temp1$xx)
ifelse(!is.null(temp1$xx), 10, 5)
ifelse(is.null(temp1$xx), 10, 5)
