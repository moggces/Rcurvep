<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run parametric fits using types of models on concentration-response datasets — run_fit • Rcurvep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run parametric fits using types of models on concentration-response datasets — run_fit" />
<meta property="og:description" content="Confidence intervals of activity metrics can be obtained through bootstrap approach.
The bootstrap samples are generated by adding the residuals (the difference between the original responses and the Hill fit) to
the fitted response (strictly to Hill equation)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rcurvep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/practical_rcurvep.html">Practical applications using Rcurvep package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run parametric fits using types of models on concentration-response datasets</h1>
    
    <div class="hidden name"><code>run_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Confidence intervals of activity metrics can be obtained through bootstrap approach.
The bootstrap samples are generated by adding the residuals (the difference between the original responses and the Hill fit) to
the fitted response (strictly to Hill equation).</p>
    </div>

    <pre class="usage"><span class='fu'>run_fit</span><span class='op'>(</span>
  <span class='va'>d</span>,
  modls <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"hill"</span>, <span class='st'>"cnst"</span><span class='op'>)</span>,
  keep_sets <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fit_set"</span>, <span class='st'>"resp_set"</span><span class='op'>)</span>,
  n_samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>Datasets with concentration-response data.
An example is <a href='zfishbeh.html'>zfishbeh</a>.
mask column is optional.</p></td>
    </tr>
    <tr>
      <th>modls</th>
      <td><p>The model types for the fitting. Multiple values are allowed.
Currently Hill model (hill) and constant model (cnst) are implemented.
Default = c("hill", "cnst").</p></td>
    </tr>
    <tr>
      <th>keep_sets</th>
      <td><p>Output datasets. Multiple values are allowed.
Default values are fit_set and resp_set.
fit_set is a must.</p><ul>
<li><p>fit_set: a tibble with output from model fits</p></li>
<li><p>resp_set: a tibble with fitted response data from the winning model</p></li>
</ul></td>
    </tr>
    <tr>
      <th>n_samples</th>
      <td><p>NULL (default) for no bootstrap samples are generated or number of samples to be generated from bootstrapping.
When n_samples is not NULL, fit_modls = "hill" will be set automatically.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>The named input configurations for replacing the default configurations.
The input configuration needs to add model type as the prefix.
For example, hill_pdir = -1 will set the Hill fit only to the decreasing direction.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of named components: result and result_nested.
The result component is also a list of output sets depending on the parameter, <em>keep_sets</em>.
The result_nested component is a tibble with input data nested in a column, input,
and output data nested in a column, output.</p>
<p>The prefix of the column names in the <em>fit_set</em> are the used models.
The <em>win_modl</em> is the winning model.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='fit_modls.html'>fit_modls()</a></code> for model fit information and the following analyses using <code><a href='summarize_fit_output.html'>summarize_fit_output()</a></code>.
for dichotomous response (see <a href='zfishdev.html'>zfishdev</a>), use <code><a href='create_dataset.html'>create_dataset()</a></code> first.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># default</span>
<span class='va'>fitd</span> <span class='op'>&lt;-</span> <span class='fu'>run_fit</span><span class='op'>(</span><span class='va'>zfishbeh</span><span class='op'>)</span>

<span class='co'># use only hill model and fit only to the decreasing direction, keep only the fit_set output</span>
<span class='va'>fitd</span> <span class='op'>&lt;-</span> <span class='fu'>run_fit</span><span class='op'>(</span><span class='va'>zfishbeh</span>, modls <span class='op'>=</span> <span class='st'>"hill"</span>, keep_sets <span class='op'>=</span> <span class='st'>"fit_set"</span>, hill_pdir <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'># fit to the bootstrap samples</span>
<span class='va'>fitd</span> <span class='op'>&lt;-</span> <span class='fu'>run_fit</span><span class='op'>(</span><span class='va'>zfishbeh</span>, n_samples <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jui-Hua Hsieh, Alexander Sedykh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


