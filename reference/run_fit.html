<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Confidence intervals of activity metrics can be obtained through bootstrap approach.
The bootstrap samples are generated by adding the residuals (the difference between the original responses and the Hill fit) to
the fitted response (only for Hill equation, 3-parameter)."><title>Run parametric fits using types of models on concentration-response datasets — run_fit • Rcurvep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run parametric fits using types of models on concentration-response datasets — run_fit"><meta property="og:description" content="Confidence intervals of activity metrics can be obtained through bootstrap approach.
The bootstrap samples are generated by adding the residuals (the difference between the original responses and the Hill fit) to
the fitted response (only for Hill equation, 3-parameter)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Rcurvep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/future_rcurvep.html">Parallel Computing Examples Using Rcurvep</a>
    <a class="dropdown-item" href="../articles/practical_rcurvep.html">Practical applications using Rcurvep package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/moggces/Rcurvep/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Run parametric fits using types of models on concentration-response datasets</h1>
      <small class="dont-index">Source: <a href="https://github.com/moggces/Rcurvep/blob/HEAD/R/tcplfit_onerun.R" class="external-link"><code>R/tcplfit_onerun.R</code></a></small>
      <div class="d-none name"><code>run_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Confidence intervals of activity metrics can be obtained through bootstrap approach.
The bootstrap samples are generated by adding the residuals (the difference between the original responses and the Hill fit) to
the fitted response (only for Hill equation, 3-parameter).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_fit</span><span class="op">(</span><span class="va">d</span>, <span class="va">modls</span>, keep_sets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fit_set"</span>, <span class="st">"resp_set"</span><span class="op">)</span>, n_samples <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>d</dt>
<dd><p>Datasets with concentration-response data.
An example is <a href="zfishbeh.html">zfishbeh</a>.
mask column is optional.</p></dd>


<dt>modls</dt>
<dd><p>The model types for the fitting.
Currently available models are 3-parameter Hill model (hill), constant model (cnst),
and Curve Class2 4-parameter Hill model (cc2).
Multiple values are only allowed for the hill and cnst combination.</p></dd>


<dt>keep_sets</dt>
<dd><p>Output datasets. Multiple values are allowed.
Default values are fit_set and resp_set.
fit_set is a must.</p><ul><li><p>fit_set: a tibble with output from model fits</p></li>
<li><p>resp_set: a tibble with fitted response data from the winning model.
If winning model is hill + no fit or cc2 + hit=4(inactive), response is NA.
If winning model is cnst, median of all responses is reported for each concentration.</p></li>
</ul></dd>


<dt>n_samples</dt>
<dd><p>NULL (default) for no bootstrap samples are generated or number of samples to be generated from bootstrapping.
When n_samples is not NULL, modls currently needs to be hill.</p></dd>


<dt>...</dt>
<dd><p>The named input configurations for replacing the default configurations.
The input configuration needs to add model type as the prefix.
For example, hill_pdir = -1 will set the Hill fit only to the decreasing direction.
Add cc2_classSD = 10 will set the classification SD to 10%.
Often 5% or 10% are used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of named components: result and result_nested.
The result component is also a list of output sets depending on the parameter, <em>keep_sets</em>.
The result_nested component is a tibble with input data nested in a column, input,
and output data nested in a column, output.</p>
    </div>
    <div class="section level2">
    <h2 id="data-structure">Data structure<a class="anchor" aria-label="anchor" href="#data-structure"></a></h2>
    <p>output
|- result (list)
|   |- fit_set
|   |- resp_set
|
|- result_nested (tibble)</p>
<p>The prefix of the column names in the <em>fit_set</em> are the used models.
The <em>win_modl</em> is the winning model.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fit_modls.html">fit_modls()</a></code> for model fit information and the following analyses using <code><a href="summarize_fit_output.html">summarize_fit_output()</a></code>.
for dichotomous response (see <a href="zfishdev.html">zfishdev</a>), use <code><a href="create_dataset.html">create_dataset()</a></code> first.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It is suggested to use na.omit on the dataset to see if any data will be removed</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># use hill + cnst model</span></span></span>
<span class="r-in"><span><span class="va">fitd</span> <span class="op">&lt;-</span> <span class="fu">run_fit</span><span class="op">(</span><span class="va">zfishbeh</span>, modls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hill"</span>, <span class="st">"cnst"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use only hill model and fit only to the decreasing direction, keep only the fit_set output</span></span></span>
<span class="r-in"><span><span class="va">fitd</span> <span class="op">&lt;-</span> <span class="fu">run_fit</span><span class="op">(</span><span class="va">zfishbeh</span>, modls <span class="op">=</span> <span class="st">"hill"</span>, keep_sets <span class="op">=</span> <span class="st">"fit_set"</span>, hill_pdir <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use cc2 model + higher classification SD</span></span></span>
<span class="r-in"><span><span class="va">fitd</span> <span class="op">&lt;-</span> <span class="fu">run_fit</span><span class="op">(</span><span class="va">zfishbeh</span>, modls <span class="op">=</span> <span class="st">"cc2"</span>, cc2_classSD <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit to the bootstrap samples using hill</span></span></span>
<span class="r-in"><span><span class="va">fitd</span> <span class="op">&lt;-</span> <span class="fu">run_fit</span><span class="op">(</span><span class="va">zfishbeh</span>, n_samples <span class="op">=</span> <span class="fl">2</span>, modls <span class="op">=</span> <span class="st">"hill"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jui-Hua Hsieh, Alexander Sedykh, Tongan Zhao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

